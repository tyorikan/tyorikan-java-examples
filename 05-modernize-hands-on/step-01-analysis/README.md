# Step 1: レガシーアプリケーションの分析とビルド

## 🎯 このステップのゴール
このステップでは、モダナイゼーションの対象となる「レガシーWebアプリケーション」の構造を理解し、自分のPC（ローカル環境）でビルドして動かせるようになることを目指します。

まずは現状を把握することが、モダナイゼーションの確実な第一歩です。

## 📖 アプリケーションの概要
このアプリケーションは、Javaで書かれたシンプルなWebアプリケーションです。以下のような、少し前の時代の技術で作られています。

- **Java Servlet / JSP**: HTMLを動的に生成するためのJavaの標準的な技術です。
- **Apache Struts 1.x**: Webアプリケーションの骨組みを作るための「フレームワーク」と呼ばれるものです。現在ではよりモダンなフレームワーク（例: Spring Boot）に置き換わることが多いです。
- **Apache Maven**: プログラムのビルドや、必要なライブラリ（依存関係）を管理するためのツールです。

## 📂 主要なファイルとディレクトリ
アプリケーションのコードは `src` ディレクトリにあります。特に重要なものをいくつか見てみましょう。

```
.
├── pom.xml               # Mavenの設定ファイル。プロジェクトの設計図。
└── src
    ├── main
    │   ├── java          # Javaのソースコード
    │   │   └── com/example/
    │   │       ├── action/HelloAction.java  # 画面からのリクエストを処理するクラス
    │   │       └── service/HelloService.java # ビジネスロジックを記述するクラス
    │   ├── resources
    │   │   └── struts.xml  # Strutsフレームワークの設定ファイル
    │   └── webapp        # Webコンテンツのルートディレクトリ
    │       ├── index.jsp   # トップページの見た目を定義するファイル
    │       └── WEB-INF
    │           ├── web.xml     # Webアプリケーション全体の設定ファイル
    │           └── jsp/hello.jsp # 結果表示画面の見た目を定義するファイル
    └── test
        └── java              # テスト用のソースコード
```

- `pom.xml`: このプロジェクトがどのようなライブラリに依存しているか、どうやってビルドするかが書かれています。
- `src/main/java`: アプリケーションの本体となるJavaコードが置かれています。
- `src/main/webapp`: ユーザーに見える画面（JSPファイル）や、Webアプリケーションとしての設定ファイル (`web.xml`) が置かれています。

## 🛠️ ビルド方法 (プログラムの組み立て)
Mavenを使って、アプリケーションを「WAR (Web Application Archive) ファイル」という形式にパッケージングします。これは、Webサーバーにデプロイするための形式です。

以下のコマンドをターミナルで実行してください。

```bash
mvn clean package
```

成功すると、`target/legacy-tomcat-app.war` というファイルが作成されます。これがアプリケーションの本体です。

## 🏃 ローカルでの実行と動作確認
このプロジェクトは、Mavenのプラグインを使って、開発用のJettyサーバーを起動することができます。

以下のコマンドを実行してください。

```bash
mvn jetty:run
```

サーバーが起動したら、Webブラウザで以下のURLにアクセスしてください。

[http://localhost:8080/legacy-tomcat-app/](http://localhost:8080/legacy-tomcat-app/)

"Hello Struts!" というタイトルのページが表示され、名前を入力して送信すると、次の画面にメッセージが表示されるはずです。

サーバーを停止するには、ターミナルで `Ctrl + C` を押してください。

## ✅ テストの実行
このプロジェクトには、アプリケーションのロジックが正しく動作することを確認するための「テストコード」が `src/test/java` に含まれています。

以下のコマンドでテストを実行できます。

```bash
mvn test
```

`BUILD SUCCESS` と表示されれば、すべてのテストが成功しており、アプリケーションが期待通りに動作することが保証されています。

---

これで、レガシーアプリケーションの現状確認は完了です。
次のステップでは、このアプリケーションを「コンテナ化」して、Cloud RunやGKEで動かすための準備を始めます。